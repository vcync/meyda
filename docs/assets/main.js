!function(){var e={909:function(e){var t,o;(o=function(e){window.hasOwnProperty("webkitAudioContext")&&!window.hasOwnProperty("AudioContext")&&(window.AudioContext=webkitAudioContext),navigator.hasOwnProperty("webkitGetUserMedia")&&!navigator.hasOwnProperty("getUserMedia")&&(navigator.getUserMedia=webkitGetUserMedia,AudioContext.prototype.hasOwnProperty("createScriptProcessor")||(AudioContext.prototype.createScriptProcessor=AudioContext.prototype.createJavaScriptNode)),this.context=new AudioContext;var o=document.getElementById("elvisSong"),r=this.context.createMediaElementSource(o);r.connect(this.context.destination),this.meyda=Meyda.createMeydaAnalyzer({audioContext:this.context,source:r,bufferSize:e,windowingFunction:"blackman"}),t=this,this.initializeMicrophoneSampling()}).prototype.initializeMicrophoneSampling=function(){var e=function(e){"suspended"===t.context.state&&document.body.addEventListener("touchend",(function e(){t.context.resume(),setTimeout((function(){"running"===t.context.state&&document.body.removeEventListener("touchend",e,!1)}),0)}),!1)};try{navigator.getUserMedia=navigator.webkitGetUserMedia||navigator.getUserMedia||navigator.mediaDevices.getUserMedia;var o=function(e){document.getElementById("audioControl").style.display="none",console.log("User allowed microphone access."),console.log("Initializing AudioNode from MediaStream");var o=t.context.createMediaStreamSource(e);console.log("Setting Meyda Source to Microphone"),t.meyda.setSource(o),console.groupEnd()};console.log("Asking for permission..."),navigator.getUserMedia({video:!1,audio:!0},o,e)&&(p.then(o),p.catch(e))}catch(t){e()}},o.prototype.get=function(e){return t.context.resume(),t.meyda.get(e)},e.exports=o}},t={};function o(r){var n=t[r];if(void 0!==n)return n.exports;var i=t[r]={exports:{}};return e[r](i,i.exports,o),i.exports}!function(){"use strict";var e=["C","C#","D","Eb","E","F","F#","G","G#","A","Bb","B"],t=1024,r=new(o(909))(t),n=new THREE.Scene,i=new THREE.PerspectiveCamera(40,1.6,.1,1e3),a=new THREE.LineBasicMaterial({color:65280}),c=(new THREE.LineBasicMaterial({color:65535}),function(e,t){for(var o=[],r=0;r<20;r++)o.push(Array.apply(null,Array(1024)).map(Number.prototype.valueOf,0));return o}()),d=new THREE.WebGLRenderer({canvas:document.querySelector("canvas")});function s(){d.domElement.style.width="100%",d.domElement.style.height="auto";var e=d.domElement.clientWidth/16*10;d.setPixelRatio(window.devicePixelRatio?window.devicePixelRatio:1),d.setSize(1.6*e,e),d.domElement.style.width="100%",d.domElement.style.height="auto",i.aspect=1.6*e/e,i.updateProjectionMatrix()}s(),window.addEventListener("resize",s);var u=new THREE.DirectionalLight(16777215,.5);u.position.set(0,1,1),n.add(u),i.position.z=5;var l=new THREE.Vector3(0,1,0),p=new THREE.Vector3(1,0,0),m=new THREE.Vector3(1,-6,-15),g=new THREE.ArrowHelper(l,m,1,16776960),w=new THREE.ArrowHelper(l,m,1,255),y=new THREE.ArrowHelper(p,m,1,16711935),E=new THREE.Group;n.add(g),n.add(w),n.add(y);for(var f=0;f<c.length;f++)if(c[f]){var h=new THREE.BufferGeometry,v=new Float32Array(3*c[f].length);h.addAttribute("position",new THREE.BufferAttribute(v,3)),h.setDrawRange(0,c[f].length);var b=new THREE.Line(h,a);E.add(b),v=b.geometry.attributes.position.array}var M=new THREE.BufferGeometry,R=new THREE.Line(M,a),x=new Float32Array(3072);M.addAttribute("position",new THREE.BufferAttribute(x,3)),M.setDrawRange(0,t),x=R.geometry.attributes.position.array,n.add(R),n.add(E);var A=null,H=document.querySelector("#chroma"),T=document.querySelector("#mfcc");!function o(){if(A=r.get(["amplitudeSpectrum","spectralCentroid","spectralRolloff","loudness","rms","chroma","mfcc"])){H&&A.chroma&&(H.innerHTML=A.chroma.reduce((function(t,o,r){return"".concat(t,'\n          <div class="chroma-band" style="background-color: rgba(0,').concat(Math.round(255*o),',0,1)">').concat(e[r],"</div>")}),"")),T&&A.mfcc&&(T.innerHTML=A.mfcc.reduce((function(e,t,o){return"".concat(e,'\n          <div class="mfcc-band" style="background-color: rgba(0,').concat(5*Math.round(t+25),',0,1)">').concat(o,"</div>")}),"")),c.pop(),c.unshift(A.amplitudeSpectrum);for(var a=r.meyda._m.signal,s=0;s<c.length;s++){for(var u=E.children[s].geometry.attributes.position.array,l=0,p=0;p<3*c[s].length;p++)u[l++]=10.7+8*Math.log10(p/c[s].length),u[l++]=.1*c[s][p]-5,u[l++]=-15-s;E.children[s].geometry.attributes.position.needsUpdate=!0}if(A.spectralCentroid&&g.position.set(10.7+8*Math.log10(A.spectralCentroid/512),-6,-15),A.spectralRolloff){var m=A.spectralRolloff/22050;w.position.set(10.7+8*Math.log10(m),-6,-15)}if(A.rms&&y.position.set(-11,10*A.rms-5,-15),a){for(var f=R.geometry.attributes.position.array,h=0,v=0;v<t;v++)f[h++]=22*v/t-11,f[h++]=4+5*a[v],f[h++]=-25;R.geometry.attributes.position.needsUpdate=!0}}requestAnimationFrame(o),d.render(n,i)}()}()}();