!function(){var e={909:function(e){var t,o;(o=function(e){window.hasOwnProperty("webkitAudioContext")&&!window.hasOwnProperty("AudioContext")&&(window.AudioContext=webkitAudioContext),navigator.hasOwnProperty("webkitGetUserMedia")&&!navigator.hasOwnProperty("getUserMedia")&&(navigator.getUserMedia=webkitGetUserMedia,AudioContext.prototype.hasOwnProperty("createScriptProcessor")||(AudioContext.prototype.createScriptProcessor=AudioContext.prototype.createJavaScriptNode)),this.context=new AudioContext;var o=document.getElementById("elvisSong"),n=this.context.createMediaElementSource(o);n.connect(this.context.destination),this.meyda=Meyda.createMeydaAnalyzer({audioContext:this.context,source:n,bufferSize:e,windowingFunction:"blackman"}),t=this,this.initializeMicrophoneSampling()}).prototype.initializeMicrophoneSampling=function(){var e=function(e){"suspended"===t.context.state&&document.body.addEventListener("touchend",(function e(){t.context.resume(),setTimeout((function(){"running"===t.context.state&&document.body.removeEventListener("touchend",e,!1)}),0)}),!1)};try{navigator.getUserMedia=navigator.webkitGetUserMedia||navigator.getUserMedia||navigator.mediaDevices.getUserMedia;var o=function(e){document.getElementById("audioControl").style.display="none",console.log("User allowed microphone access."),console.log("Initializing AudioNode from MediaStream");var o=t.context.createMediaStreamSource(e);console.log("Setting Meyda Source to Microphone"),t.meyda.setSource(o),console.groupEnd()};console.log("Asking for permission..."),navigator.mediaDevices.getUserMedia({audio:!0}).then(o).catch((function(t){console.log(t),navigator.getUserMedia({audio:!0},o,(function(t){e()}))}))}catch(t){e()}},o.prototype.get=function(e){return t.context.resume(),t.meyda.get(e)},e.exports=o}},t={};function o(n){var r=t[n];if(void 0!==r)return r.exports;var i=t[n]={exports:{}};return e[n](i,i.exports,o),i.exports}!function(){"use strict";var e=["C","C#","D","Eb","E","F","F#","G","G#","A","Bb","B"],t=1024,n=new(o(909))(t),r=new THREE.Scene,i=new THREE.PerspectiveCamera(40,1.6,.1,1e3),a=new THREE.LineBasicMaterial({color:65280}),c=(new THREE.LineBasicMaterial({color:65535}),function(e,t){for(var o=[],n=0;n<20;n++)o.push(Array.apply(null,Array(1024)).map(Number.prototype.valueOf,0));return o}()),s=new THREE.WebGLRenderer({canvas:document.querySelector("canvas")});function d(){s.domElement.style.width="100%",s.domElement.style.height="auto";var e=s.domElement.clientWidth/16*10;s.setPixelRatio(window.devicePixelRatio?window.devicePixelRatio:1),s.setSize(1.6*e,e),s.domElement.style.width="100%",s.domElement.style.height="auto",i.aspect=1.6*e/e,i.updateProjectionMatrix()}d(),window.addEventListener("resize",d);var u=new THREE.DirectionalLight(16777215,.5);u.position.set(0,1,1),r.add(u),i.position.z=5;var l=new THREE.Vector3(0,1,0),p=new THREE.Vector3(1,0,0),m=new THREE.Vector3(1,-6,-15),g=new THREE.ArrowHelper(l,m,1,16776960),w=new THREE.ArrowHelper(l,m,1,255),f=new THREE.ArrowHelper(p,m,1,16711935),y=new THREE.Group;r.add(g),r.add(w),r.add(f);for(var E=0;E<c.length;E++)if(c[E]){var v=new THREE.BufferGeometry,h=new Float32Array(3*c[E].length);v.addAttribute("position",new THREE.BufferAttribute(h,3)),v.setDrawRange(0,c[E].length);var b=new THREE.Line(v,a);y.add(b),h=b.geometry.attributes.position.array}var M=new THREE.BufferGeometry,R=new THREE.Line(M,a),x=new Float32Array(3072);M.addAttribute("position",new THREE.BufferAttribute(x,3)),M.setDrawRange(0,t),x=R.geometry.attributes.position.array,r.add(R),r.add(y);var A=null,H=document.querySelector("#chroma"),T=document.querySelector("#mfcc");!function o(){if(A=n.get(["amplitudeSpectrum","spectralCentroid","spectralRolloff","loudness","rms","chroma","mfcc"])){H&&A.chroma&&(H.innerHTML=A.chroma.reduce((function(t,o,n){return"".concat(t,'\n          <div class="chroma-band" style="background-color: rgba(0,').concat(Math.round(255*o),',0,1)">').concat(e[n],"</div>")}),"")),T&&A.mfcc&&(T.innerHTML=A.mfcc.reduce((function(e,t,o){return"".concat(e,'\n          <div class="mfcc-band" style="background-color: rgba(0,').concat(5*Math.round(t+25),',0,1)">').concat(o,"</div>")}),"")),c.pop(),c.unshift(A.amplitudeSpectrum);for(var a=n.meyda._m.signal,d=0;d<c.length;d++){for(var u=y.children[d].geometry.attributes.position.array,l=0,p=0;p<3*c[d].length;p++)u[l++]=10.7+8*Math.log10(p/c[d].length),u[l++]=.1*c[d][p]-5,u[l++]=-15-d;y.children[d].geometry.attributes.position.needsUpdate=!0}if(A.spectralCentroid&&g.position.set(10.7+8*Math.log10(A.spectralCentroid/512),-6,-15),A.spectralRolloff){var m=A.spectralRolloff/22050;w.position.set(10.7+8*Math.log10(m),-6,-15)}if(A.rms&&f.position.set(-11,10*A.rms-5,-15),a){for(var E=R.geometry.attributes.position.array,v=0,h=0;h<t;h++)E[v++]=22*h/t-11,E[v++]=4+5*a[h],E[v++]=-25;R.geometry.attributes.position.needsUpdate=!0}}requestAnimationFrame(o),s.render(r,i)}()}()}();